# ðŸ” Authentication Flow Diagram

## Registration Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         REGISTRATION FLOW                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

USER                    FRONTEND                  BACKEND              DATABASE
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚  1. Fill Form          â”‚                         â”‚                    â”‚
  â”‚  (Select Role)         â”‚                         â”‚                    â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚  2. Click Register     â”‚                         â”‚                    â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚  3. POST /auth/register â”‚                    â”‚
  â”‚                        â”‚  {                      â”‚                    â”‚
  â”‚                        â”‚    email,               â”‚                    â”‚
  â”‚                        â”‚    password,            â”‚                    â”‚
  â”‚                        â”‚    firstName,           â”‚                    â”‚
  â”‚                        â”‚    lastName,            â”‚                    â”‚
  â”‚                        â”‚    role,                â”‚                    â”‚
  â”‚                        â”‚    company              â”‚                    â”‚
  â”‚                        â”‚  }                      â”‚                    â”‚
  â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  4. Check Email    â”‚
  â”‚                        â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                        â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                        â”‚                         â”‚  (Email Available)  â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  5. Hash Password  â”‚
  â”‚                        â”‚                         â”‚  (bcrypt)          â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  6. Create User    â”‚
  â”‚                        â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                        â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                        â”‚                         â”‚  (User Created)    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  7. Create Profile â”‚
  â”‚                        â”‚                         â”‚  (Based on Role)   â”‚
  â”‚                        â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                        â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                        â”‚                         â”‚  (Profile Created) â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  8. Generate JWT   â”‚
  â”‚                        â”‚                         â”‚  (Sign Token)      â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚  9. Response            â”‚                    â”‚
  â”‚                        â”‚  {                      â”‚                    â”‚
  â”‚                        â”‚    success: true,       â”‚                    â”‚
  â”‚                        â”‚    tokens: {            â”‚                    â”‚
  â”‚                        â”‚      accessToken,       â”‚                    â”‚
  â”‚                        â”‚      refreshToken       â”‚                    â”‚
  â”‚                        â”‚    },                   â”‚                    â”‚
  â”‚                        â”‚    user: {              â”‚                    â”‚
  â”‚                        â”‚      id, email, role,   â”‚                    â”‚
  â”‚                        â”‚      firstName,         â”‚                    â”‚
  â”‚                        â”‚      lastName, company  â”‚                    â”‚
  â”‚                        â”‚    }                    â”‚                    â”‚
  â”‚                        â”‚  }                      â”‚                    â”‚
  â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚  10. Store Tokens       â”‚                    â”‚
  â”‚                        â”‚  localStorage.setItem() â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚  11. Redirect          â”‚                         â”‚                    â”‚
  â”‚  (Based on Role)       â”‚                         â”‚                    â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚  CANDIDATE â†’ /my-assessments                     â”‚                    â”‚
  â”‚  EMPLOYER  â†’ /dashboard                          â”‚                    â”‚
  â”‚  ADMIN     â†’ /admin                              â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
```

---

## Login Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            LOGIN FLOW                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

USER                    FRONTEND                  BACKEND              DATABASE
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚  1. Enter Credentials  â”‚                         â”‚                    â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚  2. Click Login        â”‚                         â”‚                    â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚  3. POST /auth/login    â”‚                    â”‚
  â”‚                        â”‚  {                      â”‚                    â”‚
  â”‚                        â”‚    email,               â”‚                    â”‚
  â”‚                        â”‚    password             â”‚                    â”‚
  â”‚                        â”‚  }                      â”‚                    â”‚
  â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  4. Find User      â”‚
  â”‚                        â”‚                         â”‚  (By Email)        â”‚
  â”‚                        â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                        â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                        â”‚                         â”‚  (User + Profiles) â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  5. Verify Passwordâ”‚
  â”‚                        â”‚                         â”‚  (bcrypt.compare)  â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  6. Check isActive â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  7. Update Login   â”‚
  â”‚                        â”‚                         â”‚  (lastLogin time)  â”‚
  â”‚                        â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                        â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  8. Create Session â”‚
  â”‚                        â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                        â”‚                         â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                        â”‚                         â”‚  (Session Created) â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  9. Generate JWT   â”‚
  â”‚                        â”‚                         â”‚  (Sign Token)      â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚  10. Extract Names â”‚
  â”‚                        â”‚                         â”‚  (From Profiles)   â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚  11. Response           â”‚                    â”‚
  â”‚                        â”‚  {                      â”‚                    â”‚
  â”‚                        â”‚    success: true,       â”‚                    â”‚
  â”‚                        â”‚    tokens: {            â”‚                    â”‚
  â”‚                        â”‚      accessToken,       â”‚                    â”‚
  â”‚                        â”‚      refreshToken       â”‚                    â”‚
  â”‚                        â”‚    },                   â”‚                    â”‚
  â”‚                        â”‚    user: {              â”‚                    â”‚
  â”‚                        â”‚      id, email, role,   â”‚                    â”‚
  â”‚                        â”‚      firstName,         â”‚                    â”‚
  â”‚                        â”‚      lastName, company  â”‚                    â”‚
  â”‚                        â”‚    }                    â”‚                    â”‚
  â”‚                        â”‚  }                      â”‚                    â”‚
  â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚                        â”‚  12. Store Tokens       â”‚                    â”‚
  â”‚                        â”‚  localStorage.setItem() â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
  â”‚  13. Redirect          â”‚                         â”‚                    â”‚
  â”‚  (Based on Role)       â”‚                         â”‚                    â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚                    â”‚
  â”‚                        â”‚                         â”‚                    â”‚
```

---

## Role-Based Profile Creation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PROFILE CREATION BY ROLE                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CANDIDATE Registration:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Table   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚
â”‚ email        â”‚
â”‚ password     â”‚â”€â”€â”
â”‚ role: CAND   â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                  â”‚
                  â”œâ”€â”€> Creates
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CandidateProfile     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ userId (FK)          â”‚
â”‚ fullName             â”‚ â† "John Doe"
â”‚ phoneNumber          â”‚
â”‚ location             â”‚
â”‚ title                â”‚
â”‚ skills []            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

EMPLOYER Registration:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Table   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚
â”‚ email        â”‚
â”‚ password     â”‚â”€â”€â”
â”‚ role: EMP    â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                  â”‚
                  â”œâ”€â”€> Creates
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EmployerProfile      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ userId (FK)          â”‚
â”‚ companyName          â”‚ â† "Tech Corp"
â”‚ companyEmail         â”‚
â”‚ phoneNumber          â”‚
â”‚ companyLocation      â”‚
â”‚ industry             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ADMIN Registration:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Table   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id           â”‚
â”‚ email        â”‚
â”‚ password     â”‚â”€â”€â”
â”‚ role: ADMIN  â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                  â”‚
                  â”œâ”€â”€> Creates
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AdminProfile         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ userId (FK)          â”‚
â”‚ fullName             â”‚ â† "Admin User"
â”‚ phoneNumber          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Token Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          TOKEN LIFECYCLE                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. TOKEN GENERATION (Backend)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ jwt.sign({                          â”‚
   â”‚   userId: user.id,                  â”‚
   â”‚   role: user.role,                  â”‚
   â”‚   email: user.email,                â”‚
   â”‚   sessionId: session.id             â”‚
   â”‚ }, JWT_SECRET, { expiresIn: '7d' }) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ JWT Token Generated                 â”‚
   â”‚ eyJhbGciOiJIUzI1NiIsInR5cCI6...    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. TOKEN STORAGE (Frontend)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ localStorage.setItem(               â”‚
   â”‚   'accessToken',                    â”‚
   â”‚   tokens.accessToken                â”‚
   â”‚ )                                   â”‚
   â”‚                                     â”‚
   â”‚ localStorage.setItem(               â”‚
   â”‚   'refreshToken',                   â”‚
   â”‚   tokens.refreshToken               â”‚
   â”‚ )                                   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. TOKEN USAGE (API Requests)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ api.interceptors.request.use(       â”‚
   â”‚   (config) => {                     â”‚
   â”‚     const token = localStorage      â”‚
   â”‚       .getItem('accessToken');      â”‚
   â”‚     config.headers.Authorization    â”‚
   â”‚       = `Bearer ${token}`;          â”‚
   â”‚     return config;                  â”‚
   â”‚   }                                 â”‚
   â”‚ )                                   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. TOKEN VERIFICATION (Backend)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ jwt.verify(                         â”‚
   â”‚   token,                            â”‚
   â”‚   JWT_SECRET                        â”‚
   â”‚ )                                   â”‚
   â”‚                                     â”‚
   â”‚ âœ“ Valid â†’ Allow Request             â”‚
   â”‚ âœ— Invalid â†’ 401 Unauthorized        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ERROR SCENARIOS                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SCENARIO 1: User Already Exists
   Frontend                Backend                 Response
      â”‚                       â”‚                        â”‚
      â”‚  POST /register       â”‚                        â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
      â”‚                       â”‚  Check Email           â”‚
      â”‚                       â”‚  (Email Exists)        â”‚
      â”‚                       â”‚                        â”‚
      â”‚                       â”‚  400 Bad Request       â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
      â”‚  {                    â”‚                        â”‚
      â”‚    success: false,    â”‚                        â”‚
      â”‚    message: "User     â”‚                        â”‚
      â”‚    already exists"    â”‚                        â”‚
      â”‚  }                    â”‚                        â”‚
      â”‚                       â”‚                        â”‚
      â”‚  Show Error Toast     â”‚                        â”‚
      â”‚                       â”‚                        â”‚

SCENARIO 2: Invalid Credentials
   Frontend                Backend                 Response
      â”‚                       â”‚                        â”‚
      â”‚  POST /login          â”‚                        â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
      â”‚                       â”‚  Find User             â”‚
      â”‚                       â”‚  (Not Found OR         â”‚
      â”‚                       â”‚   Wrong Password)      â”‚
      â”‚                       â”‚                        â”‚
      â”‚                       â”‚  401 Unauthorized      â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
      â”‚  {                    â”‚                        â”‚
      â”‚    success: false,    â”‚                        â”‚
      â”‚    message: "Invalid  â”‚                        â”‚
      â”‚    credentials"       â”‚                        â”‚
      â”‚  }                    â”‚                        â”‚
      â”‚                       â”‚                        â”‚
      â”‚  Show Error Toast     â”‚                        â”‚
      â”‚                       â”‚                        â”‚

SCENARIO 3: Account Deactivated
   Frontend                Backend                 Response
      â”‚                       â”‚                        â”‚
      â”‚  POST /login          â”‚                        â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚
      â”‚                       â”‚  Find User             â”‚
      â”‚                       â”‚  (isActive = false)    â”‚
      â”‚                       â”‚                        â”‚
      â”‚                       â”‚  403 Forbidden         â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
      â”‚  {                    â”‚                        â”‚
      â”‚    success: false,    â”‚                        â”‚
      â”‚    message: "Account  â”‚                        â”‚
      â”‚    is deactivated"    â”‚                        â”‚
      â”‚  }                    â”‚                        â”‚
      â”‚                       â”‚                        â”‚
      â”‚  Show Error Toast     â”‚                        â”‚
      â”‚                       â”‚                        â”‚
```

---

## Data Structure Comparison

### BEFORE (Broken)
```javascript
// Backend Response
{
  token: "jwt_token",
  user: {
    id: "123",
    email: "user@test.com",
    role: "CANDIDATE",
    profile: {
      fullName: "John Doe",
      phoneNumber: "123-456-7890"
    }
  }
}

// Frontend Expected
{
  tokens: {
    accessToken: "jwt_token",
    refreshToken: "jwt_token"
  },
  user: {
    firstName: "John",
    lastName: "Doe"
  }
}
// âŒ MISMATCH!
```

### AFTER (Fixed)
```javascript
// Backend Response
{
  success: true,
  tokens: {
    accessToken: "jwt_token",
    refreshToken: "jwt_token"
  },
  user: {
    id: "123",
    email: "user@test.com",
    role: "CANDIDATE",
    firstName: "John",
    lastName: "Doe",
    company: null
  }
}

// Frontend Expected
{
  tokens: {
    accessToken: "jwt_token",
    refreshToken: "jwt_token"
  },
  user: {
    id: "123",
    email: "user@test.com",
    role: "CANDIDATE",
    firstName: "John",
    lastName: "Doe",
    company: null
  }
}
// âœ… PERFECT MATCH!
```

---

## Security Features

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SECURITY LAYERS                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 1: Password Security
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Plain Password               â”‚
   â”‚ "password123"                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼ bcrypt.hash(password, 10)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Hashed Password              â”‚
   â”‚ "$2a$10$N9qo8uLOickgx..."   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 2: JWT Token Security
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Payload + Secret             â”‚
   â”‚ jwt.sign(data, JWT_SECRET)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Signed Token                 â”‚
   â”‚ Cannot be tampered with      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 3: HTTP-Only Cookies
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ res.cookie('token', token, { â”‚
   â”‚   httpOnly: true,            â”‚
   â”‚   secure: true,              â”‚
   â”‚   sameSite: 'strict'         â”‚
   â”‚ })                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 4: Session Tracking
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Session Table                â”‚
   â”‚ - Device Info                â”‚
   â”‚ - IP Address                 â”‚
   â”‚ - Expiry Time                â”‚
   â”‚ - Valid Flag                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Layer 5: Email Verification
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Verification Token           â”‚
   â”‚ crypto.randomBytes(32)       â”‚
   â”‚ Sent via Email               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Status:** âœ… COMPLETE
**Last Updated:** February 10, 2026
